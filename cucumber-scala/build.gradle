plugins {
    id "org.jetbrains.intellij" version "0.6.1"
    id "scala"
}

group 'com.github.danielwegener'
version "${versions.idea}"

compileScala.sourceCompatibility = "1.8"
compileScala.targetCompatibility = "1.8"

dependencies {
    compileOnly libs.scala
    implementation(libs.cucumberScala) {
        exclude group: 'org.scala-lang', module: 'scala-library'
    }

    testImplementation libs.scala
    testImplementation libs.jUnit
    testImplementation libs.cucumberJUnit
    testImplementation libs.scalatest
}

intellij {
    pluginName 'intellij-cucumber-scala'
    version "${versions.idea}"
    type "IC"

    plugins = [
            "java",
            "org.intellij.scala:${versions.scalaPlugin}",
            "gherkin:${versions.gherkin}"
    ]
    updateSinceUntilBuild true
}

runIde {
    jvmArgs '-Didea.debugger.trace=ALL'
}

patchPluginXml {
    sinceBuild "202.7660"
    untilBuild "202.*"
}

buildSearchableOptions.enabled = false

publishPlugin {
    token findProperty("PUBLISH_TOKEN") ?: System.getenv("PUBLISH_TOKEN")
}